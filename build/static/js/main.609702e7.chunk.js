(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{70:function(e,t,n){},79:function(e,t,n){"use strict";n.r(t);var s=n(1),i=n.n(s),a=n(15),r=n.n(a),o=n(21),l=n(8),c=n(9),h=n(14),d=n(13),p=n(40),u=n.n(p),j=n(82),m=n(7),b=n.n(m),g=(n(69),n(70),n(81));var v=function(e){var t=Object(g.a)();return Object.values(e.people).forEach((function(n){e.peopleState[n.name].isShown&&n.draw(t,e.peopleState[n.name])})),null},f=(n(71),n(72),n(41)),y=n.n(f),O=n(0);window.screenfull=y.a,delete b.a.Icon.Default.prototype._getIconUrl,b.a.Icon.Default.mergeOptions({iconUrl:"/static/images/marker-icon.png",iconRetinaUrl:"/static/images/marker-icon-2x.png",shadowUrl:"/static/images/marker-shadow.png"});var x=[36.08851338894426,10.80333970970808];var w=function(e){return console.log("start render Map",Date.now()),Object(O.jsxs)(j.a,{center:x,zoom:7.8,fullscreenControl:!0,whenCreated:function(t){e.setMap(t),b.a.tileLayer("https://stamen-tiles-{s}.a.ssl.fastly.net/watercolor/{z}/{x}/{y}.jpg",{}).addTo(t),b.a.tileLayer("https://tiles.openseamap.org/seamark/{z}/{x}/{y}.png").addTo(t),b.a.control.scale({imperial:!1}).addTo(t)},children:["/>",Object(O.jsx)(v,{people:e.people,peopleState:e.peopleState})]})};n(74);function S(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"black",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"black";return b.a.divIcon({html:'<svg \n height="24"\n  viewBox="0 0 512 512"\n   width="24"\n   preserveAspectRatio="none"\n    xmlns="http://www.w3.org/2000/svg">\n    <g>\n    <path d="m90.997 364.003h119.998v-216.821l-132.375 193.347c-6.805 9.94.33 23.474 12.377 23.474z" fill="'+e+'"> </path>\n    <path d="m488.49 391.572h-224.999v-27.569h149.997c8.28 0 15-6.72 15-15 0-45.429-9.19-87.148-27.32-124.008-29.039-59.049-81.459-104.268-137.677-127.378v-82.608c0-10.61-10.75-17.85-20.55-13.93-.05.02-.09.04-.14.05-4.03 1.66-89.908 36.969-90.008 37.009-12.31 5.06-12.39 22.51-.13 27.69l80.829 34.129v291.615h-209.994c-9.217 0-16.388 8.233-14.803 17.86 16.103 105.627 13.38 87.765 13.693 89.818 1.112 7.331 7.414 12.75 14.83 12.75h335.291c51.636 0 97.805-29.107 120.101-73.312.075.006.152.007.227.013 4.44-8.93 7.89-18.39 10.24-28.21 2.365-9.88-4.925-18.919-14.587-18.919zm-224.999-248.235c40.059 49.959 40.119 120.338 0 170.367z" fill="'+t+'" ></path>\n    </g></svg>',className:"dummy",iconSize:[0,0],iconAnchor:[12,12]})}function D(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return t?1===t?e.substring(0,4)+"-"+e.substring(4,6)+"-"+e.substring(6,8):void 0:e.substring(6,8)+"/"+e.substring(4,6)+"/"+e.substring(0,4)}function k(e){return e.substr(0,2)+":"+e.substr(2,2)}var P=function(){function e(){Object(l.a)(this,e),this.current=0,this.names=["#00ffff","#ff00ff","#ffff00","#ffffff","#ffb6c1","#ffa500","#00ff00","#bdb76b","#00008b","#008b8b","#a9a9a9","#006400","#9932cc","#e9967a","#add8e6","#e0ffff","#90ee90","#d3d3d3","#808000","#ffc0cb","#800080","#00ff00","#0000ff","#f0ffff","#f5f5dc","#8b008b","#556b2f","#ff8c00","#ffd700","#008000","#4b0082","#f0e68c","#ffffe0","#000080","#800080","#c0c0c0"]}return Object(c.a)(e,[{key:"getNext",value:function(){var e=this.names[this.current];return this.current++,this.current%=this.names.length,e}},{key:"shadeHexColor",value:function(e,t){var n=parseInt(e.slice(1),16),s=t<0?0:255,i=t<0?-1*t:t,a=n>>16,r=n>>8&255,o=255&n;return"#"+(16777216+65536*(Math.round((s-a)*i)+a)+256*(Math.round((s-r)*i)+r)+(Math.round((s-o)*i)+o)).toString(16).slice(1)}}]),e}();var I=function(){function e(t){Object(l.a)(this,e),this.lt=t.lt,this.lg=t.lg,this.date=t.da,this.time=t.ti,this.id=t.id,this.tm="DIs"===t.tm,this.interval=-1}return Object(c.a)(e,[{key:"getMarker",value:function(e,t,n){return b.a.marker([this.lt,this.lg],{icon:e||this.tm?n[1]:n[0],riseOnHover:!0,zIndexOffset:this.tm?100:0}).bindPopup(function(e,t){if(!(arguments.length>2&&void 0!==arguments[2])||arguments[2])return'<p style="text-align:center;">'+t+"<br>("+e.lt+" , "+e.lg+")<br>"+D(e.date)+" at "+k(e.time)+"</p>"}(this,t))}}]),e}(),C=function(){function e(t){Object(l.a)(this,e),this.SOSmarkers=[],this.sos=[],this.polylines=[],this.name="",this.positions=[],this.markers=[],this.problems=[],this.layerGroup=b.a.layerGroup(),this.allSOS=[],this.name=t}return Object(c.a)(e,[{key:"update",value:function(e){var t,n=null,s=[];if(this.markers=[],this.polylines=[],this.problems=[],this.SOSmarkers=[],e.isShown){var i,a=Object(o.a)(this.positions);try{for(a.s();!(i=a.n()).done;)if(t=i.value,this.checkDate(t,e)){var r=!1;n&&this.checkProblem(t,n)&&(this.insertPolyline(s,t),s=[[n.lt,n.lg],[t.lt,t.lg]],this.insertPolyline(s,t,"b",!0,n),s=[],r=!0,this.problems.push([t,n])),s.push([t.lt,t.lg]),t.tm?this.allSOS.push([t.getMarker(r,this.name,this.icons),t]):this.markers.push(t.getMarker(r,this.name,this.icons)),n=t}}catch(l){a.e(l)}finally{a.f()}this.insertPolyline(s,t,"c"),this.allSOS.length>0&&(this.SOSmarkers=[this.allSOS[0]])}}},{key:"checkProblem",value:function(e,t){var n=new Date(D(e.date,1)+" "+k(e.time)),s=new Date(D(t.date,1)+" "+k(t.time))-n;return(s=s/1e3/60)>120}},{key:"insertPolyline",value:function(e,t){var n=this,s=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;if(!(e.length<=1)){var a,r,o=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return t?n.name+" "+D(s.date)+" "+k(s.time)+" => "+D(e.date)+" "+k(e.time):'<p style="text-align:center;">this.name</p>'};s?(a={color:"red",dashArray:"20,20"},r=o(t,s,i)):(a={color:this.color},r=o(t)),this.polylines.push(b.a.polyline(e,a).bindPopup(r))}}},{key:"checkDate",value:function(e,t){var n=new Date(D(e.date,1));return t.startDate<=n&&n<=t.endDate}},{key:"draw",value:function(e,t){t.allPos?(this.layerGroup=b.a.layerGroup(this.polylines.concat(this.markers)),this.layerGroup.addTo(e)):this.markers.length>0&&(this.layerGroup=b.a.layerGroup([this.markers[0]]),this.layerGroup.addTo(e)),this.SOSmarkers.forEach((function(t){var n=t[0],s=t[1];0!==s.interval&&-1!==s.interval||(s.interval=setInterval((function(){e.hasLayer(n)?e.removeLayer(n):e.addLayer(n)}),1e3))}))}},{key:"undrawSOS",value:function(){this.SOSmarkers.forEach((function(e){var t=e[0],n=e[1];clearInterval(n.interval),t.remove(),n.interval=0}))}}]),e}(),M=n(18),B=n(85),E=n(12);function z(e){return Math.floor(Math.random()*e)}var A=function(e){Object(h.a)(n,e);var t=Object(d.a)(n);function n(e){var s;return Object(l.a)(this,n),(s=t.call(this,e)).temp=z(100),s.thermIcon=E.h,s.temp>80?s.thermIcon=E.e:s.temp>60?s.thermIcon=E.h:s.temp>40?s.thermIcon=E.f:s.temp>20?s.thermIcon=E.g:s.thermIcon=E.d,s.voltage=(z(15)+20+Math.random()).toPrecision(4),s.tempSys=z(70),s}return Object(c.a)(n,[{key:"render",value:function(){var e=this;return Object(O.jsxs)("div",{children:[Object(O.jsx)("span",{children:this.props.name}),Object(O.jsxs)("div",{children:[Object(O.jsxs)("div",{style:{display:"flex"},children:[Object(O.jsx)(B.a.Check,{type:"switch",checked:this.props.isShown,onChange:function(){e.props.togglePerson(e.props.name)}}),Object(O.jsx)("span",{children:"show"})]}),Object(O.jsxs)("div",{style:{display:"flex"},children:[Object(O.jsx)(B.a.Check,{type:"switch",checked:this.props.isAllPos,disabled:!this.props.isShown,onChange:function(){e.props.toggleAllPos(e.props.name)}}),Object(O.jsxs)("span",{children:["all pos (",this.props.posCount,")"]})]})]}),Object(O.jsx)("hr",{style:{width:"25%"}}),Object(O.jsxs)("div",{style:{marginTop:"5px",marginBottom:"10px"},children:[Object(O.jsx)("strong",{style:{paddingBottom:"10px"},children:"Date Filter:"}),Object(O.jsx)("br",{}),Object(O.jsxs)("div",{style:{display:"flex",justifyContent:"space-around"},children:[Object(O.jsxs)("span",{children:[" from:",Object(O.jsx)("input",{type:"date",onChange:function(t){return e.props.setDate(e.props.name,0,t.target.value)},value:this.props.startDate.yyyymmdd()})]}),Object(O.jsxs)("span",{style:{marginLeft:"10px"},children:[" to:",Object(O.jsx)("input",{type:"date",onChange:function(t){return e.props.setDate(e.props.name,1,t.target.value)},value:this.props.endDate.yyyymmdd()})]})]})]}),Object(O.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",padding:"20px"},children:[Object(O.jsxs)("div",{children:[Object(O.jsx)(M.a,{icon:this.thermIcon,size:"2x"}),Object(O.jsx)("span",{style:{marginRight:"10px"}}),this.temp,"\xb0C"]}),Object(O.jsxs)("div",{children:[Object(O.jsx)(M.a,{icon:E.b,size:"2x"}),Object(O.jsx)("span",{style:{marginRight:"10px"}}),this.tempSys,"\xb0C"]}),Object(O.jsxs)("div",{children:[Object(O.jsx)(M.a,{icon:E.a,size:"2x"}),Object(O.jsx)("span",{style:{marginRight:"10px"}}),"Full : ",this.voltage," V"]}),Object(O.jsxs)("div",{children:[Object(O.jsx)(M.a,{icon:E.c,size:"2x"}),Object(O.jsx)("span",{style:{marginRight:"10px"}}),"charging..."]})]})]})}}]),n}(s.Component),G=n(84),T=n(83);var L=function(e){var t=e.problems.map((function(e,t){return Object(O.jsxs)("tr",{children:[Object(O.jsx)("td",{children:t+1}),Object(O.jsxs)("td",{children:[D(e[0].date)," ",k(e[0].time)]}),Object(O.jsxs)("td",{children:["(",e[0].lt," , ",e[0].lg,")"]}),Object(O.jsxs)("td",{children:[D(e[1].date)," ",k(e[1].time)]}),Object(O.jsxs)("td",{children:["(",e[1].lt," , ",e[1].lg,")"]})]},e[0].id+e[1].id)})),n=e.sos.map((function(e,t){return Object(O.jsxs)("tr",{children:[Object(O.jsx)("td",{children:t+1}),Object(O.jsxs)("td",{children:[D(e.date)," ",k(e.time)]}),Object(O.jsxs)("td",{children:["(",e.lt," , ",e.lg,")"]})]},e.id)}));return Object(O.jsxs)(G.a,{children:[Object(O.jsxs)(G.a.Item,{eventKey:"0",children:[Object(O.jsxs)(G.a.Header,{children:["Infractions (",t.length,")"]}),Object(O.jsx)(G.a.Body,{children:Object(O.jsxs)(T.a,{striped:!0,bordered:!0,hover:!0,children:[Object(O.jsx)("thead",{children:Object(O.jsxs)("tr",{children:[Object(O.jsx)("th",{children:"#"}),Object(O.jsx)("th",{children:"time 1"}),Object(O.jsx)("th",{children:"position 1"}),Object(O.jsx)("th",{children:"time 2"}),Object(O.jsx)("th",{children:"position 2"})]})}),Object(O.jsx)("tbody",{children:t})]})})]}),Object(O.jsxs)(G.a.Item,{eventKey:"1",children:[Object(O.jsxs)(G.a.Header,{children:["SOS (",n.length,")"]}),Object(O.jsx)(G.a.Body,{children:Object(O.jsxs)(T.a,{striped:!0,bordered:!0,hover:!0,children:[Object(O.jsx)("thead",{children:Object(O.jsxs)("tr",{children:[Object(O.jsx)("th",{children:"#"}),Object(O.jsx)("th",{children:"time"}),Object(O.jsx)("th",{children:"position"})]})}),Object(O.jsx)("tbody",{children:n})]})})]})]})},W=function(e){Object(h.a)(n,e);var t=Object(d.a)(n);function n(){return Object(l.a)(this,n),t.apply(this,arguments)}return Object(c.a)(n,[{key:"render",value:function(){return Object(O.jsxs)("div",{style:{padding:"10px 3px",border:"2px #7e8182 solid",marginTop:"4px"},children:[Object(O.jsx)("div",{children:Object(O.jsx)(A,{isShown:this.props.isShown,isAllPos:this.props.allPos,startDate:this.props.startDate,endDate:this.props.endDate,name:this.props.name,togglePerson:this.props.togglePerson,toggleAllPos:this.props.toggleAllPos,setDate:this.props.setDate,posCount:this.props.posCount})}),Object(O.jsx)(L,{problems:this.props.problems,sos:this.props.sos})]})}}]),n}(s.Component),R=W,H=n(16),U=n.n(H),F=function(e){Object(h.a)(n,e);var t=Object(d.a)(n);function n(){var e;Object(l.a)(this,n);for(var s=arguments.length,i=new Array(s),a=0;a<s;a++)i[a]=arguments[a];return(e=t.call.apply(t,[this].concat(i))).invalidateMap=U()((function(){return e.props.map.invalidateSize()}),500),e.setMargin=U()((function(e){return document.getElementById("cont").style.marginTop=e.clientY-20+"px"}),100),e.isToggled=!1,e}return Object(c.a)(n,[{key:"render",value:function(){var e=this,t=this.props,n=t.widths,s=t.problems,i=t.peopleState,a=n[0],r=n[1];return Object(O.jsxs)("div",{style:{display:"flex"},children:[Object(O.jsx)("div",{id:"a",style:{width:"5vw"},onClick:function(){e.isToggled?(document.getElementById("personPanelDiv").style.width="100%",document.getElementById("mapDiv").style.width=a,document.getElementById("rightPanelDiv").style.width=r):(document.getElementById("personPanelDiv").style.width="0",document.getElementById("mapDiv").style.width="95vw",document.getElementById("rightPanelDiv").style.width="5vw"),document.getElementById("arrows").classList.toggle("rotate"),console.log("**************************\n",e.props.map),e.invalidateMap(),e.isToggled=!e.isToggled},onMouseMove:function(t){return e.setMargin(t)},children:Object(O.jsx)("div",{id:"cont",children:Object(O.jsx)("span",{children:Object(O.jsx)("div",{style:{width:"30px",height:"30px"},children:Object(O.jsx)("svg",{id:"arrows",xmlns:"http://www.w3.org/2000/svg",width:"100%",height:"100%",viewBox:"0 0 24 24",children:Object(O.jsx)("path",{d:"M0 3.795l2.995-2.98 11.132 11.185-11.132 11.186-2.995-2.981 8.167-8.205-8.167-8.205zm18.04 8.205l-8.167 8.205 2.995 2.98 11.132-11.185-11.132-11.186-2.995 2.98 8.167 8.206z"})})})})})}),Object(O.jsx)("div",{id:"personPanelDiv",style:{overflowY:"scroll",height:"100vh",width:"100%"},children:Object.keys(i).map((function(t){return Object(O.jsx)(R,{name:t,isShown:i[t].isShown,allPos:i[t].allPos,startDate:i[t].startDate,endDate:i[t].endDate,togglePerson:e.props.togglePerson,toggleAllPos:e.props.toggleAllPos,setDate:e.props.setDate,problems:s[t],sos:e.props.sos[t],posCount:e.props.posCount[t]},t)}))})]})}}]),n}(s.Component),N=F;Date.prototype.yyyymmdd=function(){var e=this.getMonth()+1,t=this.getDate();return[this.getFullYear(),(e>9?"":"0")+e,(t>9?"":"0")+t].join("-")};var Y=[],J=[],K=function(e){Object(h.a)(n,e);var t=Object(d.a)(n);function n(){var e;Object(l.a)(this,n);for(var s=arguments.length,i=new Array(s),a=0;a<s;a++)i[a]=arguments[a];return(e=t.call.apply(t,[this].concat(i))).state={peopleState:[]},e.debouncedCallback=U()((function(){e.map.invalidateSize(),e.rightW=document.getElementById("rightPanelDiv").style.width,e.mapW=document.getElementById("mapDiv").style.width}),500),e.mapW="60vw",e.rightW="40vw",e.map={},e}return Object(c.a)(n,[{key:"componentDidMount",value:function(){var e=this;console.log("start ComponentDidMount",Date.now()),this.rightW=document.getElementById("rightPanelDiv").style.width,this.mapW=document.getElementById("mapDiv").style.width,u.a.get("/api").then((function(t){console.log("start axios",Date.now());var n,s=new P,i=Object(o.a)(t.data);try{for(i.s();!(n=i.n()).done;){var a=n.value;if(void 0===J[a.na]){J[a.na]=new C(a.na);var r=s.getNext();J[a.na].icons=[S(r),S(r,"red")],J[a.na].color=r,Y[a.na]={isShown:!0,allPos:!1,startDate:new Date("2021-01-01"),endDate:new Date("2022-01-01")}}J[a.na].positions.push(new I(a))}}catch(l){i.e(l)}finally{i.f()}Object.values(J).map((function(e){return e.update(Y[e.name])})),e.setState({peopleState:Y})})),window.addEventListener("resize",(function(){e.debouncedCallback()}))}},{key:"togglePerson",value:function(e){var t=Object.assign({},this.state.peopleState);t[e].isShown=!t[e].isShown,J[e].layerGroup.remove(),J[e].undrawSOS(),this.setState({peopleState:t})}},{key:"toggleAllPos",value:function(e){var t=Object.assign({},this.state.peopleState);t[e].allPos=!t[e].allPos,J[e].layerGroup.remove(),this.setState({peopleState:t})}},{key:"setDate",value:function(e,t,n){var s=Object.assign({},this.state.peopleState);0===t?s[e].startDate=new Date(n):s[e].endDate=new Date(n),J[e].layerGroup.remove(),J[e].undrawSOS(),J[e].update(s[e]),this.setState({layerGroups:s})}},{key:"setMap",value:function(e){this.map=e}},{key:"render",value:function(){console.log("start render",Date.now());var e=[],t=[],n=[];return Object.values(J).forEach((function(s){e[s.name]=s.problems;var i;i=s.allSOS.map((function(e){return e[1]})),t[s.name]=i,n[s.name]=s.markers.length})),Object(O.jsxs)("div",{id:"main",children:[Object(O.jsx)("div",{id:"mapDiv",children:Object(O.jsx)(w,{id:"mapEl",people:J,peopleState:this.state.peopleState,setMap:this.setMap.bind(this)})}),Object(O.jsx)("div",{id:"rightPanelDiv",children:Object(O.jsx)(N,{widths:[this.mapW,this.rightW],map:this.map,peopleState:Y,togglePerson:this.togglePerson.bind(this),setDate:this.setDate.bind(this),toggleAllPos:this.toggleAllPos.bind(this),problems:e,sos:t,posCount:n})})]})}}]),n}(s.Component),V=K;r.a.render(Object(O.jsx)(i.a.StrictMode,{children:Object(O.jsx)(V,{})}),document.getElementById("root"))}},[[79,1,2]]]);
//# sourceMappingURL=main.609702e7.chunk.js.map